# EverythingInBot - Render.com Deployment Guide

**Complete step-by-step guide to deploy EverythingInBot to Render.com**

---

## üìã Prerequisites

Before deploying, ensure you have:

1. ‚úÖ GitHub repository: https://github.com/anyjobhub/EverythingInBot
2. ‚úÖ Render.com account (free tier available)
3. ‚úÖ MongoDB Atlas account (free tier M0)
4. ‚úÖ Telegram Bot Token (from @BotFather)
5. ‚úÖ API Keys (OpenAI, Anthropic, Google AI - optional)

---

## üóÑÔ∏è Step 1: Setup MongoDB Atlas

### 1.1 Create MongoDB Cluster

1. Go to [MongoDB Atlas](https://www.mongodb.com/cloud/atlas)
2. Sign up / Log in
3. Create a **FREE M0 cluster**
   - Provider: AWS
   - Region: Choose closest to Oregon (for Render)
   - Cluster Name: `EverythingInBot`

### 1.2 Configure Database Access

1. **Database Access** ‚Üí **Add New Database User**
   - Username: `everythinginbot`
   - Password: Generate secure password (save it!)
   - Database User Privileges: **Read and write to any database**

### 1.3 Configure Network Access

1. **Network Access** ‚Üí **Add IP Address**
   - Click **"Allow Access from Anywhere"** (0.0.0.0/0)
   - This is required for Render.com

### 1.4 Get Connection String

1. **Database** ‚Üí **Connect** ‚Üí **Connect your application**
2. Driver: **Python** / Version: **3.11 or later**
3. Copy connection string:
   ```
   mongodb+srv://everythinginbot:<password>@cluster0.xxxxx.mongodb.net/?retryWrites=true&w=majority
   ```
4. Replace `<password>` with your actual password
5. Add database name: `/everythinginbot` before the `?`
   ```
   mongodb+srv://everythinginbot:YOUR_PASSWORD@cluster0.xxxxx.mongodb.net/everythinginbot?retryWrites=true&w=majority
   ```

---

## ü§ñ Step 2: Setup Telegram Bot

### 2.1 Create Bot

1. Open Telegram and search for **@BotFather**
2. Send `/newbot`
3. Choose a name: `EverythingInBot`
4. Choose a username: `EverythingInBot` (must end with 'bot')
5. **Save the bot token** (looks like `123456789:ABCdefGHIjklMNOpqrsTUVwxyz`)

### 2.2 Configure Bot

```
/setdescription - Set bot description
/setabouttext - Set about text
/setuserpic - Upload bot profile picture
/setcommands - Set bot commands
```

**Recommended Commands**:
```
start - Start the bot
help - Get help
ai - AI Chat Assistant
breach - Check email/password breaches
courses - Browse free courses
jobs - Find job opportunities
tools - Utility tools
productivity - Notes & reminders
devtools - Developer utilities
cybersec - Cybersecurity tools
osint - OSINT research tools
fun - Fun & entertainment
```

---

## üöÄ Step 3: Deploy to Render.com

### 3.1 Connect GitHub Repository

1. Go to [Render Dashboard](https://dashboard.render.com/)
2. Click **"New +"** ‚Üí **"Blueprint"**
3. Connect your GitHub account
4. Select repository: **`anyjobhub/EverythingInBot`**
5. Render will detect `render.yaml` automatically

### 3.2 Configure Environment Variables

Render will create 4 services:
- **everythinginbot-web** (Web Service)
- **everythinginbot-worker** (Celery Worker)
- **everythinginbot-beat** (Celery Beat Scheduler)
- **everythinginbot-redis** (Redis Cache)

#### Required Environment Variables (Web Service)

| Variable | Value | Notes |
|----------|-------|-------|
| `TELEGRAM_BOT_TOKEN` | Your bot token from BotFather | **Required** |
| `MONGODB_URI` | MongoDB connection string | **Required** |
| `TELEGRAM_WEBHOOK_SECRET` | Auto-generated by Render | Auto-set |
| `REDIS_URL` | Auto-linked from Redis service | Auto-set |
| `JWT_SECRET_KEY` | Auto-generated by Render | Auto-set |
| `ENVIRONMENT` | `production` | Auto-set |

#### Optional API Keys (Web Service)

| Variable | Value | Purpose |
|----------|-------|---------|
| `OPENAI_API_KEY` | `sk-...` | GPT-4o AI chat |
| `ANTHROPIC_API_KEY` | `sk-ant-...` | Claude AI chat |
| `GOOGLE_AI_API_KEY` | `...` | Gemini AI chat |
| `YOUTUBE_API_KEY` | `...` | YouTube course fetching |
| `XPOSEDORNOT_API_KEY` | `...` | Breach checking |

#### Worker/Beat Services

These services need:
- `MONGODB_URI` (same as web)
- `REDIS_URL` (auto-linked)
- `YOUTUBE_API_KEY` (if using YouTube courses)
- `ENVIRONMENT` = `production`

### 3.3 Set Environment Variables

**For Web Service**:
1. Go to **everythinginbot-web** ‚Üí **Environment**
2. Add each variable:
   - Click **"Add Environment Variable"**
   - Key: `TELEGRAM_BOT_TOKEN`
   - Value: Paste your bot token
   - Click **"Save Changes"**
3. Repeat for `MONGODB_URI` and optional API keys

**For Worker Service**:
1. Go to **everythinginbot-worker** ‚Üí **Environment**
2. Add `MONGODB_URI` (same value as web service)
3. Add `YOUTUBE_API_KEY` (if you have it)

**For Beat Service**:
1. Go to **everythinginbot-beat** ‚Üí **Environment**
2. Add `MONGODB_URI` (same value as web service)
3. Add `YOUTUBE_API_KEY` (if you have it)

### 3.4 Deploy Services

1. Click **"Apply"** to create all services
2. Render will:
   - Build all services
   - Install dependencies
   - Start services
3. Wait 5-10 minutes for deployment

---

## üîó Step 4: Configure Telegram Webhook

### 4.1 Get Render Web Service URL

1. Go to **everythinginbot-web** service
2. Copy the URL (e.g., `https://everythinginbot-web.onrender.com`)

### 4.2 Webhook is Auto-Configured

The bot automatically sets the webhook on startup! No manual configuration needed.

**Webhook URL**: `https://your-service.onrender.com/webhook`

### 4.3 Verify Webhook

Test your bot:
1. Open Telegram
2. Search for your bot
3. Send `/start`
4. You should get a response!

---

## ‚úÖ Step 5: Verify Deployment

### 5.1 Check Service Health

**Web Service**:
```bash
curl https://your-service.onrender.com/health
```

Expected response:
```json
{
  "status": "healthy",
  "database": "connected",
  "redis": "connected"
}
```

**Check Logs**:
1. Go to each service in Render
2. Click **"Logs"** tab
3. Look for:
   - ‚úÖ `Database connected successfully`
   - ‚úÖ `Redis connected successfully`
   - ‚úÖ `Webhook set to: https://...`
   - ‚úÖ `Application startup complete`

### 5.2 Test Bot Functionality

**Basic Commands**:
```
/start - Should show main menu
/help - Should show help text
```

**Test Modules**:
1. Click "ü§ñ AI Chat" - Test AI responses
2. Click "üíº Jobs & Careers" - Should show job categories
3. Click "üìö Courses & Learning" - Should show course categories
4. Click "üîç OSINT Tools" - Should show disclaimer

### 5.3 Verify Background Tasks

**Check Celery Worker**:
1. Go to **everythinginbot-worker** logs
2. Look for: `celery@... ready`

**Check Celery Beat**:
1. Go to **everythinginbot-beat** logs
2. Look for: `beat: Starting...`
3. Should see scheduled tasks:
   - `fetch-jobs-every-6-hours`
   - `fetch-courses-every-12-hours`

**Trigger Initial Data Fetch** (Optional):

You can manually trigger the first data fetch by accessing:
```
https://your-service.onrender.com/api/admin/trigger-job-fetch
https://your-service.onrender.com/api/admin/trigger-course-fetch
```

Or wait for the scheduled tasks to run automatically.

---

## üêõ Troubleshooting

### Issue: Bot Not Responding

**Check**:
1. Webhook set correctly? Check web service logs
2. Environment variables set? Check `TELEGRAM_BOT_TOKEN`
3. Service running? Check if web service is "Live"

**Solution**:
```bash
# Check webhook status
curl https://api.telegram.org/bot<YOUR_BOT_TOKEN>/getWebhookInfo
```

### Issue: Database Connection Failed

**Check**:
1. MongoDB URI correct?
2. IP whitelist includes 0.0.0.0/0?
3. Database user has read/write permissions?

**Solution**:
- Re-check MongoDB Atlas network access
- Verify connection string format
- Test connection locally first

### Issue: Celery Tasks Not Running

**Check**:
1. Redis connected? Check worker logs
2. Beat service running? Check beat logs
3. MongoDB connected? Check worker logs

**Solution**:
- Restart worker service
- Restart beat service
- Check Redis service is "Live"

### Issue: Jobs/Courses Not Showing

**Reason**: Data hasn't been fetched yet (first fetch takes 6-12 hours)

**Solution**:
1. Wait for scheduled tasks to run
2. Or manually trigger initial fetch
3. Check worker logs for fetch status

### Issue: Free Tier Limitations

**Render Free Tier**:
- Services sleep after 15 minutes of inactivity
- 750 hours/month (shared across services)
- Cold start delay (~30 seconds)

**Solution**:
- Upgrade to paid plan ($7/month per service)
- Or use external uptime monitor (e.g., UptimeRobot)

---

## üìä Monitoring & Maintenance

### Daily Checks

1. **Service Health**:
   - All 4 services should be "Live"
   - Check for any error logs

2. **Bot Functionality**:
   - Test `/start` command
   - Verify modules working

3. **Background Tasks**:
   - Check worker logs for task completion
   - Verify jobs/courses are updating

### Weekly Maintenance

1. **Review Logs**:
   - Check for errors or warnings
   - Monitor API rate limits

2. **Database**:
   - Check MongoDB Atlas metrics
   - Verify TTL indexes working

3. **Performance**:
   - Monitor response times
   - Check Redis memory usage

### Monthly Tasks

1. **Update Dependencies**:
   ```bash
   pip list --outdated
   ```

2. **Security Updates**:
   - Update API keys if needed
   - Review access logs

3. **Backup**:
   - Export MongoDB data
   - Save environment variables

---

## üí∞ Cost Breakdown

### Free Tier (Recommended for Testing)

| Service | Plan | Cost |
|---------|------|------|
| Render Web | Free | $0 |
| Render Worker | Free | $0 |
| Render Beat | Free | $0 |
| Render Redis | Free | $0 |
| MongoDB Atlas | M0 | $0 |
| **Total** | | **$0/month** |

**Limitations**:
- Services sleep after 15 min inactivity
- 750 hours/month shared
- Cold start delays

### Paid Tier (Recommended for Production)

| Service | Plan | Cost |
|---------|------|------|
| Render Web | Starter | $7/month |
| Render Worker | Starter | $7/month |
| Render Beat | Starter | $7/month |
| Render Redis | Free | $0 |
| MongoDB Atlas | M0 | $0 |
| **Total** | | **$21/month** |

**Benefits**:
- No sleep/cold starts
- Always available
- Better performance
- More resources

### Scaling (10k+ Users)

| Service | Plan | Cost |
|---------|------|------|
| Render Web | Standard | $25/month |
| Render Worker | Standard | $25/month |
| Render Beat | Starter | $7/month |
| Render Redis | 1GB | $10/month |
| MongoDB Atlas | M10 | $57/month |
| **Total** | | **$124/month** |

---

## üîí Security Best Practices

### Environment Variables

- ‚úÖ Never commit `.env` file
- ‚úÖ Use Render's secret management
- ‚úÖ Rotate API keys regularly
- ‚úÖ Use strong JWT secret

### MongoDB

- ‚úÖ Use strong password
- ‚úÖ Enable IP whitelist (0.0.0.0/0 for Render)
- ‚úÖ Regular backups
- ‚úÖ Monitor access logs

### Telegram

- ‚úÖ Use webhook secret token
- ‚úÖ Validate all inputs
- ‚úÖ Rate limiting enabled
- ‚úÖ Spam protection active

---

## üöÄ Post-Deployment Checklist

- [ ] All 4 services deployed and "Live"
- [ ] Environment variables configured
- [ ] MongoDB connected successfully
- [ ] Redis connected successfully
- [ ] Webhook set and verified
- [ ] Bot responds to `/start`
- [ ] All 10 modules working
- [ ] Celery worker running
- [ ] Celery beat scheduling tasks
- [ ] Jobs fetching automatically
- [ ] Courses fetching automatically
- [ ] Security middlewares active
- [ ] Logging working
- [ ] Admin panel accessible
- [ ] Error handling working
- [ ] Performance acceptable

---

## üìû Support & Resources

### Render.com

- [Render Documentation](https://render.com/docs)
- [Render Status](https://status.render.com/)
- [Render Community](https://community.render.com/)

### MongoDB Atlas

- [MongoDB Documentation](https://docs.atlas.mongodb.com/)
- [MongoDB University](https://university.mongodb.com/)

### Telegram Bots

- [Telegram Bot API](https://core.telegram.org/bots/api)
- [Aiogram Documentation](https://docs.aiogram.dev/)

---

## ‚úÖ Deployment Complete!

Your EverythingInBot is now live on Render.com! üéâ

**Next Steps**:
1. Test all modules thoroughly
2. Monitor logs for 24 hours
3. Share bot with beta testers
4. Collect feedback
5. Iterate and improve

**Bot URL**: `https://t.me/YourBotUsername`

---

*Deployment Guide v1.0 - February 2026*
